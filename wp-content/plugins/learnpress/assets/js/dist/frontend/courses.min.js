(()=>{"use strict";const e={};"undefined"!=typeof lpDataAdmin&&(e.admin={apiAdminNotice:lpDataAdmin.lp_rest_url+"lp/v1/admin/tools/admin-notices",apiAdminOrderStatic:lpDataAdmin.lp_rest_url+"lp/v1/orders/statistic",apiAddons:lpDataAdmin.lp_rest_url+"lp/v1/addon/all",apiAddonAction:lpDataAdmin.lp_rest_url+"lp/v1/addon/action",apiSearchCourses:lpDataAdmin.lp_rest_url+"lp/v1/admin/tools/search-course",apiSearchUsers:lpDataAdmin.lp_rest_url+"lp/v1/admin/tools/search-user",apiAssignUserCourse:lpDataAdmin.lp_rest_url+"lp/v1/admin/tools/assign-user-course",apiUnAssignUserCourse:lpDataAdmin.lp_rest_url+"lp/v1/admin/tools/unassign-user-course"}),"undefined"!=typeof lpData&&(e.frontend={apiWidgets:lpData.lp_rest_url+"lp/v1/widgets/api",apiCourses:lpData.lp_rest_url+"lp/v1/courses/archive-course",apiAJAX:lpData.lp_rest_url+"lp/v1/load_content_via_ajax/"});const t=e,r=(e,t)=>{const r=new URL(e);return Object.keys(t).forEach((e=>{r.searchParams.set(e,t[e])})),r},s={get:(e,t,r)=>{let s;if(r)s=wpCookies.get(e);else{let t=wpCookies.get("LP");t&&(t=JSON.parse(t),s=e?t[e]:t)}return s||s===t||(s=t),s},set(e,t,r,s,n,o){if(arguments.length>2)wpCookies.set(e,t,r,s,n,o);else if(2==arguments.length){let r=wpCookies.get("LP");r=r?JSON.parse(r):{},r[e]=t,wpCookies.set("LP",JSON.stringify(r),"","/")}else wpCookies.set("LP",JSON.stringify(e),"","/")},remove(e){const t=s.get(),r=new RegExp(e,"g"),n={},o=e.match(/\*/);for(const s in t)o?s.match(r)||(n[s]=t[s]):e!=s&&(n[s]=t[s]);s.set(n)}},n=s;"undefined"!=typeof lpData&&"undefined"!=typeof lpSettingCourses||console.log("lpData || lpSettingCourses is undefined"),window.lpArchiveRequestCourse=e=>{window.lpCourseList.updateEventTypeBeforeFetch("filter"),window.lpCourseList.triggerFetchAPI(e)},document.addEventListener("change",(function(e){const t=e.target;window.lpCourseList.onChangeSortBy(e,t),window.lpCourseList.onChangeTypeLayout(e,t)})),document.addEventListener("click",(function(e){const t=e.target;window.lpCourseList.clickLoadMore(e,t),window.lpCourseList.clickNumberPage(e,t)})),document.addEventListener("scroll",(function(e){const t=e.target;window.lpCourseList.scrollInfinite(e,t)})),document.addEventListener("keyup",(function(e){const t=e.target;window.lpCourseList.searchCourse(e,t)})),document.addEventListener("submit",(function(e){const t=e.target;window.lpCourseList.searchCourse(e,t)})),window.lpCourseList=(()=>{const e="lp-archive-courses",s="learn-press-courses",o="lp-archive-course-skeleton",a="courses-page-result",i=parseInt(lpSettingCourses.lpArchiveLoadAjax||0),c=1===parseInt(lpSettingCourses.lpArchiveNoLoadAjaxFirst),l=lpData.urlParams||[],u=(()=>{let e=window.location.href;return e.includes("?")&&(e=e.split("?")[0]),e})();let d={};const p=lpSettingCourses.lpArchivePaginationType||"number";let f,g,m=!1;const y=(e,s={})=>{const n=r(t.frontend.apiCourses,e);let o={};0!==parseInt(lpData.user_id)&&(o={headers:{"X-WP-Nonce":lpData.nonce}}),((e,t={},r={})=>{"function"==typeof r.before&&r.before(),fetch(e,{method:"GET",...t}).then((e=>e.json())).then((e=>{"function"==typeof r.success&&r.success(e)})).catch((e=>{"function"==typeof r.error&&r.error(e)})).finally((()=>{"function"==typeof r.completed&&r.completed()}))})(n,o,s)};return{init:()=>{const e={},t=window.location.search,r=new URLSearchParams(t);for(const[t,s]of r.entries())e[t]=s;d={...l,...e},d.paged=parseInt(d.paged||1),isNaN(d.paged)&&(d.paged=1),c&&"number"!==p&&(d.paged=1),window.localStorage.setItem("lp_filter_courses",JSON.stringify(d))},updateEventTypeBeforeFetch:e=>{f=e},onChangeSortBy:(e,t)=>{if(!t.classList.contains("courses-order-by"))return;e.preventDefault();const s=JSON.parse(window.localStorage.getItem("lp_filter_courses"))||{};s.order_by=t.value||"","undefined"!=typeof lpSettingCourses&&lpData.is_course_archive&&lpSettingCourses.lpArchiveLoadAjax?window.lpCourseList.triggerFetchAPI(s):window.location.href=r(u,s)},onChangeTypeLayout:(t,r)=>{if("lp-switch-layout-btn"!==r.getAttribute("name"))return;const o=r.closest(`.${e}`);if(!o)return;const a=o.querySelector(`.${s}`);if(!a)return;t.preventDefault();const i=r.value;i&&(a.dataset.layout=i,n.set("courses-layout",i))},clickNumberPage:(t,r)=>{if(!i||parseInt(lpSettingCourses.noLoadCoursesJs))return;if(r.classList.contains("page-numbers")){if(!r.closest(`.${e}`))return;t.preventDefault();const s=d.paged;return r.classList.contains("prev")?d.paged=s-1:r.classList.contains("next")?d.paged=s+1:d.paged=parseInt(r.textContent),f="number",void window.lpCourseList.triggerFetchAPI(d)}const s=r.closest(".page-numbers");s&&(t.preventDefault(),s.click())},clickLoadMore:(t,r)=>{if(!r.classList.contains("courses-btn-load-more"))return;const n=r.closest(`.${e}`);n&&n.querySelector(`.${s}`)&&(t.preventDefault(),++d.paged,f="load-more",window.lpCourseList.triggerFetchAPI(d))},scrollInfinite:(t,r)=>{const s=document.querySelector(`.${e}`);if(!s)return;const n=s.querySelector(".courses-load-infinite");n&&new IntersectionObserver((function(e){for(const t of e)if(t.isIntersecting){if(m)return;++d.paged,f="infinite",window.lpCourseList.triggerFetchAPI(d)}})).observe(n)},triggerFetchAPI:t=>{const r=document.querySelector(`.${e}`);if(!r)return;const n=r.querySelector(`.${s}`);if(!n)return;let o;switch(d=t,f){case"load-more":o=window.lpCourseList.callBackPaginationTypeLoadMore(r,n);break;case"infinite":o=window.lpCourseList.callBackPaginationTypeInfinite(r,n);break;case"custom":o=t.customCallBack||!1;break;default:o=window.lpCourseList.callBackFilter(t,r,n)}o&&y(t,o)},callBackFilter:(t,s,n)=>{if(!n)return;const i=n.querySelector(`.${o}`);return{before:()=>{window.history.pushState("","",r(u,t)),window.localStorage.setItem("lp_filter_courses",JSON.stringify(t)),i&&(i.style.display="block")},success:e=>{n.querySelectorAll(`:not(.${o})`).forEach((e=>{e.closest(`.${o}`)||e.remove()})),n.insertAdjacentHTML("afterbegin",e.data.content||"");const t=document.querySelector(".learn-press-pagination");t&&t.remove();const r=e.data.pagination||"";n.insertAdjacentHTML("afterend",r);const s=document.querySelector(`.${a}`);s&&(s.innerHTML=e.data.from_to||"")},error:e=>{n.innerHTML+=`<div class="lp-ajax-message error" style="display:block">${e.message||"Error"}</div>`},completed:()=>{i&&(i.style.display="none"),n.closest(`.${e}`).scrollIntoView({behavior:"smooth"})}}},callBackPaginationTypeLoadMore:(e,t)=>{if(!t||!e)return!1;const r=e.querySelector(".courses-btn-load-more");let s;return r&&(s=r.querySelector(".lp-loading-circle")),{before:()=>{r&&(s.classList.remove("hide"),r.setAttribute("disabled","disabled"))},success:e=>{t.insertAdjacentHTML("beforeend",e.data.content||""),t.insertAdjacentHTML("afterend",e.data.pagination||"");const r=document.querySelector(`.${a}`);r&&(r.innerHTML=e.data.from_to||"")},error:e=>{t.innerHTML+=`<div class="lp-ajax-message error" style="display:block">${e.message||"Error"}</div>`},completed:()=>{r&&(s.classList.add("hide"),r.remove())}}},callBackPaginationTypeInfinite:(e,t)=>{if(!t||!t)return;const r=e.querySelector(".courses-load-infinite");if(!r)return;const s=r.querySelector(".lp-loading-circle");return m=!0,r.classList.remove("courses-load-infinite"),{before:()=>{s.classList.remove("hide")},success:e=>{t.insertAdjacentHTML("beforeend",e.data.content||""),e.data.pagination&&t.insertAdjacentHTML("afterend",e.data.pagination||"");const r=document.querySelector(`.${a}`);r&&(r.innerHTML=e.data.from_to||"")},error:e=>{t.innerHTML+=`<div class="lp-ajax-message error" style="display:block">${e.message||"Error"}</div>`},completed:()=>{r.remove(),m=!1}}},searchCourse:(t,r)=>{if("c_search"===r.name){t.preventDefault();const e=r.closest("form.search-courses");if(!e)return;return void e.querySelector('button[type="submit"]').click()}if(!r.classList.contains("search-courses"))return;const n=r;t.preventDefault();const o=n.closest(`.${e}`);if(!o)return;if(!o.querySelector(`.${s}`))return;const a=n.querySelector("input[name=c_search]").value;(!a||a&&a.length>2)&&(void 0!==g&&clearTimeout(g),g=setTimeout((function(){f="filter",d.c_search=a,d.paged=1,window.lpCourseList.triggerFetchAPI(d)}),800))},ajaxEnableLoadPage:()=>{let t=0;if(!c){let r;const n={success:n=>{r=setInterval((function(){const i=document.querySelector(`.${o}`),c=document.querySelector(`.${e}`);let l;if(c&&(l=c.querySelector(`.${s}`)),++t,t>5e3&&clearInterval(r),l&&i){clearInterval(r),l.insertAdjacentHTML("afterbegin",n.data.content||""),i.style.display="none";const e=n.data.pagination||"";l.insertAdjacentHTML("afterend",e);const t=document.querySelector(`.${a}`);t&&(t.innerHTML=n.data.from_to||"")}}),1)}};"number"!==p&&(d.paged=1),y(d,n)}},getFilterParams:()=>d}})(),window.lpCourseList.init(),window.lpCourseList.ajaxEnableLoadPage()})();